{% load static %}
{% load crispy_forms_tags %}
{% load humanize %}
{% load js %}
<div class="post" id="post-{{post.id}}" href="{% url 'post:post_detail' post.id %}">
    <div class="left">
        <a href="{%url 'users:profile' post.author.profile.id %}">
            <img src="{{post.author.profile.profile_img.url}}" alt="{{post.author.username}}">
        </a>
    </div>
    <div class="right">
        <nav class="nav-top">
            <div class="info">
                <a class="alias"
                    href="{%url 'users:profile' post.author.profile.id %}">{{post.author.profile.alias}}</a>
                <p class="username">@{{post.author}}</p>
                <p class="timestamp-dot">â€¢</p>
                <p class="timestamp">{{post.timestamp|naturaltime}}</p>
            </div>
            <div class="options" id="options-{{post.id}}">
                <div class="dots">
                    <div class=" dot1"></div>
                    <div class="dot2"></div>
                    <div class="dot3"></div>
                </div>

                <div class="dropdown hover" id="dropdown-{{post.id}}">
                    {% if user == post.author %}
                    <div class="delete option" id='delete-{{post.id}}' post_id={{post.id}} method="POST">
                        <div>
                            <img src="{% static 'main/images/delete.png' %}" alt="delete">
                            <p>Delete</p>
                        </div>
                    </div>
                    <div class="option edit" id="edit-{{post.id}}" post_id={{post.id}} method="POST">
                        <div>
                            <img src="{% static 'main/images/edit.png' %}" alt="edit" form="edit-form-{{post.id}}">
                            <p>Edit</p>
                        </div>
                    </div>
                    <div class="option">
                        <div>
                            <img src="{% static 'main/images/pin.png' %}" alt="pin">
                            <p>Pin to your profile</p>
                        </div>
                    </div>
                    {% else %}
                    {% if post.author in user.following %}
                    <div class="option">
                        <div>
                            <img src="{% static 'main/images/follow.png' %}" alt="follow">
                            <p>Stop following @{{post.author}}</p>
                        </div>
                    </div>
                    {% else %}
                    <div class="option">
                        <div>
                            <img src="{% static 'main/images/unfollow.png' %}" alt="unfollow">
                            <p>Stop following @{{post.author}}</p>
                        </div>
                    </div>
                    {% endif %}
                    <div class="option">
                        <div>
                            <img src="{% static 'main/images/mute.png' %}" alt="mute">
                            <p>Mute</p>
                        </div>
                    </div>
                    <div class="option">
                        <div>
                            <img src="{% static 'main/images/block.png' %}" alt="block">
                            <p>Block</p>
                        </div>
                    </div>
                    <div class="option">
                        <div>
                            <img src="{% static 'main/images/report.png' %}" alt="report">
                            <p>Report {{post.author}}</p>
                        </div>
                    </div>
                    <div class="option">
                        <div>
                            <img src="{% static 'main/images/report.png' %}" alt="report">
                            <p>Report post</p>
                        </div>
                    </div>
                    {% endif %}
                </div>
            </div>
        </nav>

        <div class="content">
            <div class="content mx-2 py-1 " id="content-div-{{post.id}}">
                {% if post.should_snippet %}
                <p id="content1-{{post.id}}">{{post.snippet}}</p>
                <p id="show-more">show more...</p>
                {% else %}
                <p id="content2-{{post.id}}">{{post.content}}</p>
                {%endif%}
            </div>
            {% if post.author == user %}

            <div class="d-none edit-group" id="edit-group-{{post.id}}">
                <form class="form-group edit-form" method="POST" post_id="{{post.id}}"
                    action="{% url 'post:post_update' post.id %}" id="edit-form-{{post.id}}">
                    {% csrf_token %}
                    <input class="form-control " name="content" class="m-2" value="{{post.content}}" type="text"
                        maxlength=" 300" required id="input-{{post.id}}"">
                    <input name=" id" value="{{post.id}}" class="d-none">
                    <div class="edit-form-button">
                        <button type="submit" class="save-button btn btn-primary" post_id={{post.id}}
                            id="save-button-{{post.id}}">
                            Save
                        </button>
                    </div>
                </form>
            </div>
            {%endif%}

        </div>

        <nav class="nav-bot icon-set hover-set">
            <div class="like-div">
                <div class="like hover" id='like-{{post.id}}' method="POST" action="{%url 'post:post-like' post.id %}"
                    likes-count="{{post.likes.count}}" post_id={{post.id}} liked='false'>
                    <img src=" {% static 'main/images/like.png' %}" alt="like">
                    <img class="colored" src="{% static 'main/images/like_colored.png' %}" alt="like_colored">
                    <img class="liked" src="{% static 'main/images/like_liked.png' %}" alt="like_liked">
                </div>
                <p>{{post.likes.count}}</p>
            </div>

            <div class="comment">
                <div class="hover" id='comment-{{post.id}}' post_id={{post.id}}>
                    <img src="{% static 'main/images/comment.png' %}" alt="comment">
                    <img class="colored" src="{% static 'main/images/comment_colored.png' %}" alt="comment_colored">
                </div>
                <p>{{post.comments.all.count}}</p>
            </div>

            <div class="share">
                <div class="hover" id='share-{{post.id}}' post_id={{post.id}}>
                    <img src="{% static 'main/images/share.png' %}" alt="share">
                    <img class="colored" src="{% static 'main/images/share_colored.png' %}" alt="share_colored">
                </div>
                <p>0</p>
            </div>
    </div>
</div>
</div>


<div class="comments" id="comments-{{post.id}}""></div>

        {% if user.is_authenticated %}
    <div class=" d-none user-comment row px-3 py-2">
    <div class="profile-img">
        <img class="" src="{{user.profile.profile_img.url}}" alt="{{post.author}}">
    </div>

    <div class="comment-form-div col">
        <form class="comment-form" id="comment-form-{{post.id}}" post_id="{{post.id}}" method="POST"
            action="{% url 'post:post-list' %}">
            {% csrf_token %}
            <input type="text" name="content" placeholder="Write a comment..." class="form-control">
            <input type="text" name="parent" value="{{post.id}}" class="d-none">
            <button type="submit" class="d-none"></button>
        </form>
    </div>
</div>
</div>
{% endif %}